<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vectramind Email Campaign Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .logo-animation {
            animation: logoEntry 2s ease-out;
        }
        @keyframes logoEntry {
            0% { opacity: 0; transform: scale(0.8) translateY(-30px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 bg-white flex items-center justify-center z-50">
        <div class="text-center logo-animation">
            <div class="w-24 h-24 mx-auto mb-6 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center">
                <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                </svg>
            </div>
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Vectramind Technology</h1>
            <p class="text-lg text-gray-600 mb-4">Private Limited</p>
            <div class="w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"></div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="hidden fixed inset-0 bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-800">Email Campaign Manager</h2>
                <p class="text-gray-600">Vectramind Technology Pvt. Ltd.</p>
            </div>
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Login ID</label>
                    <input type="text" id="loginId" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your login ID" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 rounded-lg font-semibold hover:from-blue-700 hover:to-indigo-700 transition duration-200">
                    Sign In
                </button>
                <div class="text-center">
                    <button type="button" id="skipLogin" class="text-blue-600 hover:text-blue-700 text-sm">Skip Login (Demo Mode)</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="bg-white shadow-lg border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-800">Vectramind Email Campaign Manager</h1>
                            <p class="text-sm text-gray-600">Professional Email Marketing Solution</p>
                        </div>
                    </div>
                    <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition duration-200">
                        Logout
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-6">
                <div class="flex space-x-8">
                    <button class="nav-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium" data-tab="validation">
                        Email Validation
                    </button>
                    <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium" data-tab="campaign">
                        Campaign Manager
                    </button>
                    <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium" data-tab="analytics">
                        Analytics & Reports
                    </button>
                </div>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="max-w-7xl mx-auto px-6 py-8">
            <!-- Email Validation Tab -->
            <div id="validationTab" class="tab-content">
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Email Validation & Sorting</h2>
                    
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">Upload Email List</h3>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition duration-200">
                                <input type="file" id="emailFile" accept=".csv,.txt" class="hidden">
                                <label for="emailFile" class="cursor-pointer">
                                    <svg class="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                    </svg>
                                    <p class="text-gray-600">Click to upload email list</p>
                                    <p class="text-sm text-gray-500 mt-2">CSV or TXT format (Max 50,000 emails)</p>
                                </label>
                            </div>
                            
                            <button id="validateEmails" class="w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition duration-200 disabled:opacity-50" disabled>
                                Validate Emails
                            </button>
                        </div>

                        <div id="validationResults" class="hidden">
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">Validation Results</h3>
                            <div class="space-y-4">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex justify-between items-center">
                                        <span class="text-green-800 font-medium">Valid Emails</span>
                                        <span id="validCount" class="text-green-600 font-bold">0</span>
                                    </div>
                                </div>
                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex justify-between items-center">
                                        <span class="text-red-800 font-medium">Invalid Emails</span>
                                        <span id="invalidCount" class="text-red-600 font-bold">0</span>
                                    </div>
                                </div>
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex justify-between items-center">
                                        <span class="text-yellow-800 font-medium">Hard Bounce</span>
                                        <span id="hardBounceCount" class="text-yellow-600 font-bold">0</span>
                                    </div>
                                </div>
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                    <div class="flex justify-between items-center">
                                        <span class="text-orange-800 font-medium">Soft Bounce</span>
                                        <span id="softBounceCount" class="text-orange-600 font-bold">0</span>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="downloadValidated" class="w-full mt-6 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition duration-200">
                                Download Validated List
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Campaign Manager Tab -->
            <div id="campaignTab" class="tab-content hidden">
                <div class="space-y-8">
                    <!-- Campaign Type Selection -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">Create New Campaign</h2>
                        <div class="grid md:grid-cols-2 gap-6">
                            <button id="bulkCampaignBtn" class="campaign-type-btn p-6 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition duration-200">
                                <div class="text-center">
                                    <svg class="w-12 h-12 text-blue-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                                    </svg>
                                    <h3 class="text-lg font-semibold text-gray-800">Bulk Email Campaign</h3>
                                    <p class="text-gray-600 mt-2">Send same email to multiple recipients</p>
                                </div>
                            </button>
                            
                            <button id="customCampaignBtn" class="campaign-type-btn p-6 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition duration-200">
                                <div class="text-center">
                                    <svg class="w-12 h-12 text-green-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                    </svg>
                                    <h3 class="text-lg font-semibold text-gray-800">Custom Email Campaign</h3>
                                    <p class="text-gray-600 mt-2">Personalized emails with variables</p>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- Campaign Creation Form -->
                    <div id="campaignForm" class="bg-white rounded-xl shadow-lg p-8 hidden">
                        <h3 class="text-xl font-bold text-gray-800 mb-6" id="campaignFormTitle">Create Campaign</h3>
                        
                        <!-- HTML Template Upload -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload HTML Template</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition duration-200">
                                <input type="file" id="htmlTemplate" accept=".html" class="hidden">
                                <label for="htmlTemplate" class="cursor-pointer">
                                    <svg class="w-8 h-8 text-gray-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                    </svg>
                                    <p class="text-gray-600">Upload HTML template</p>
                                </label>
                            </div>
                        </div>

                        <!-- Template Preview -->
                        <div id="templatePreview" class="mb-6 hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Template Preview</label>
                            <div class="border border-gray-300 rounded-lg p-4 bg-gray-50 max-h-64 overflow-y-auto">
                                <div id="previewContent"></div>
                            </div>
                        </div>

                        <!-- Variable Fields (Custom Campaign Only) -->
                        <div id="variableFields" class="mb-6 hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Variable Fields</label>
                            <div id="variableList" class="space-y-2 mb-4"></div>
                            <button id="addVariable" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition duration-200">
                                Add Variable Field
                            </button>
                        </div>

                        <!-- Campaign Details -->
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Campaign Name *</label>
                                <input type="text" id="campaignName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter campaign name" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email Subject *</label>
                                <input type="text" id="emailSubject" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter email subject" required>
                            </div>
                        </div>

                        <!-- Email List Upload -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload Email List (Max 50,000)</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition duration-200">
                                <input type="file" id="campaignEmails" accept=".csv,.txt" class="hidden">
                                <label for="campaignEmails" class="cursor-pointer">
                                    <svg class="w-8 h-8 text-gray-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                    </svg>
                                    <p class="text-gray-600">Upload recipient list</p>
                                </label>
                            </div>
                        </div>

                        <!-- Campaign Actions -->
                        <div class="flex space-x-4">
                            <button id="executeCampaign" class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                                Execute Now
                            </button>
                            <button id="scheduleCampaign" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                                Schedule Campaign
                            </button>
                        </div>

                        <!-- Schedule Modal -->
                        <div id="scheduleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
                            <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Schedule Campaign</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Date</label>
                                        <input type="date" id="scheduleDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Time</label>
                                        <input type="time" id="scheduleTime" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                </div>
                                <div class="flex space-x-4 mt-6">
                                    <button id="confirmSchedule" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                                        Confirm Schedule
                                    </button>
                                    <button id="cancelSchedule" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analyticsTab" class="tab-content hidden">
                <div class="space-y-8">
                    <!-- Campaign Stats -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">Campaign Analytics</h2>
                        
                        <div class="grid md:grid-cols-4 gap-6 mb-8">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 text-center">
                                <div class="text-3xl font-bold text-blue-600" id="totalSent">0</div>
                                <div class="text-blue-800 font-medium">Total Sent</div>
                            </div>
                            <div class="bg-green-50 border border-green-200 rounded-lg p-6 text-center">
                                <div class="text-3xl font-bold text-green-600" id="deliveryRate">0%</div>
                                <div class="text-green-800 font-medium">Delivery Rate</div>
                            </div>
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-6 text-center">
                                <div class="text-3xl font-bold text-purple-600" id="openRate">0%</div>
                                <div class="text-purple-800 font-medium">Open Rate</div>
                            </div>
                            <div class="bg-orange-50 border border-orange-200 rounded-lg p-6 text-center">
                                <div class="text-3xl font-bold text-orange-600" id="bounceRate">0%</div>
                                <div class="text-orange-800 font-medium">Bounce Rate</div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700 mb-4">Delivery Statistics</h3>
                                <canvas id="deliveryChart" width="400" height="300"></canvas>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700 mb-4">Open Rate Trends</h3>
                                <canvas id="openRateChart" width="400" height="300"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Bounce Details -->
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-6">Bounce Analysis</h3>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <h4 class="text-lg font-semibold text-red-600 mb-4">Hard Bounces</h4>
                                <div class="bg-red-50 border border-red-200 rounded-lg p-4 max-h-64 overflow-y-auto">
                                    <div id="hardBounceList" class="space-y-2 text-sm text-red-800">
                                        <!-- Hard bounce emails will be listed here -->
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-lg font-semibold text-yellow-600 mb-4">Soft Bounces</h4>
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-h-64 overflow-y-auto">
                                    <div id="softBounceList" class="space-y-2 text-sm text-yellow-800">
                                        <!-- Soft bounce emails will be listed here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="downloadReports" class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-semibold transition duration-200">
                            Download Complete Report
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let validatedEmails = [];
        let campaignData = {};
        let isCustomCampaign = false;
        let variableCount = 0;

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            showLoadingScreen();
        });

        function showLoadingScreen() {
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
            }, 3000);
        }

        // Login functionality
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const loginId = document.getElementById('loginId').value;
            const password = document.getElementById('password').value;
            
            if (loginId && password) {
                currentUser = { loginId, loginTime: new Date() };
                showMainApp();
            }
        });

        document.getElementById('skipLogin').addEventListener('click', function() {
            currentUser = { loginId: 'demo', loginTime: new Date() };
            showMainApp();
        });

        document.getElementById('logoutBtn').addEventListener('click', function() {
            currentUser = null;
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('loginForm').reset();
        });

        function showMainApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            initializeCharts();
        }

        // Tab navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabName = this.dataset.tab;
                switchTab(tabName);
            });
        });

        function switchTab(tabName) {
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            document.querySelector(`[data-tab="${tabName}"]`).classList.remove('border-transparent', 'text-gray-500');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('border-blue-500', 'text-blue-600');

            // Show/hide content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            document.getElementById(`${tabName}Tab`).classList.remove('hidden');
        }

        // Email validation functionality
        document.getElementById('emailFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('validateEmails').disabled = false;
            }
        });

        document.getElementById('validateEmails').addEventListener('click', function() {
            const file = document.getElementById('emailFile').files[0];
            if (!file) return;

            // Simulate email validation process
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const emails = content.split('\n').filter(email => email.trim());
                
                // Simulate validation results
                const results = validateEmailList(emails);
                displayValidationResults(results);
            };
            reader.readAsText(file);
        });

        function validateEmailList(emails) {
            const results = {
                valid: [],
                invalid: [],
                hardBounce: [],
                softBounce: []
            };

            emails.forEach(email => {
                email = email.trim();
                if (!email) return;

                const random = Math.random();
                if (random < 0.7) {
                    results.valid.push(email);
                } else if (random < 0.8) {
                    results.invalid.push(email);
                } else if (random < 0.9) {
                    results.hardBounce.push(email);
                } else {
                    results.softBounce.push(email);
                }
            });

            validatedEmails = results;
            return results;
        }

        function displayValidationResults(results) {
            document.getElementById('validCount').textContent = results.valid.length;
            document.getElementById('invalidCount').textContent = results.invalid.length;
            document.getElementById('hardBounceCount').textContent = results.hardBounce.length;
            document.getElementById('softBounceCount').textContent = results.softBounce.length;
            
            document.getElementById('validationResults').classList.remove('hidden');
        }

        document.getElementById('downloadValidated').addEventListener('click', function() {
            if (validatedEmails.valid.length === 0) return;
            
            const csvContent = validatedEmails.valid.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'validated_emails.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        });

        // Campaign functionality
        document.getElementById('bulkCampaignBtn').addEventListener('click', function() {
            isCustomCampaign = false;
            showCampaignForm('Bulk Email Campaign');
        });

        document.getElementById('customCampaignBtn').addEventListener('click', function() {
            isCustomCampaign = true;
            showCampaignForm('Custom Email Campaign');
        });

        function showCampaignForm(title) {
            document.getElementById('campaignFormTitle').textContent = title;
            document.getElementById('campaignForm').classList.remove('hidden');
            
            if (isCustomCampaign) {
                document.getElementById('variableFields').classList.remove('hidden');
            } else {
                document.getElementById('variableFields').classList.add('hidden');
            }
        }

        // HTML template handling
        document.getElementById('htmlTemplate').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const htmlContent = e.target.result;
                    document.getElementById('previewContent').innerHTML = htmlContent;
                    document.getElementById('templatePreview').classList.remove('hidden');
                };
                reader.readAsText(file);
            }
        });

        // Variable fields management
        document.getElementById('addVariable').addEventListener('click', function() {
            variableCount++;
            const variableDiv = document.createElement('div');
            variableDiv.className = 'flex items-center space-x-2';
            variableDiv.innerHTML = `
                <input type="text" placeholder="Variable name (e.g., firstName)" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm">
                <button type="button" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-sm" onclick="this.parentElement.remove()">Remove</button>
            `;
            document.getElementById('variableList').appendChild(variableDiv);
        });

        // Campaign execution
        document.getElementById('executeCampaign').addEventListener('click', function() {
            if (validateCampaignForm()) {
                executeCampaignNow();
            }
        });

        document.getElementById('scheduleCampaign').addEventListener('click', function() {
            if (validateCampaignForm()) {
                document.getElementById('scheduleModal').classList.remove('hidden');
            }
        });

        document.getElementById('confirmSchedule').addEventListener('click', function() {
            const date = document.getElementById('scheduleDate').value;
            const time = document.getElementById('scheduleTime').value;
            
            if (date && time) {
                scheduleCampaignExecution(date, time);
                document.getElementById('scheduleModal').classList.add('hidden');
            }
        });

        document.getElementById('cancelSchedule').addEventListener('click', function() {
            document.getElementById('scheduleModal').classList.add('hidden');
        });

        function validateCampaignForm() {
            const campaignName = document.getElementById('campaignName').value;
            const emailSubject = document.getElementById('emailSubject').value;
            const emailFile = document.getElementById('campaignEmails').files[0];
            
            if (!campaignName || !emailSubject || !emailFile) {
                alert('Please fill in all required fields and upload an email list.');
                return false;
            }
            
            return true;
        }

        function executeCampaignNow() {
            // Simulate campaign execution
            const campaignName = document.getElementById('campaignName').value;
            
            // Generate mock results
            const totalEmails = Math.floor(Math.random() * 50000) + 1000;
            const delivered = Math.floor(totalEmails * (0.85 + Math.random() * 0.1));
            const opened = Math.floor(delivered * (0.15 + Math.random() * 0.25));
            const hardBounces = Math.floor(totalEmails * (0.02 + Math.random() * 0.03));
            const softBounces = Math.floor(totalEmails * (0.05 + Math.random() * 0.05));
            
            campaignData = {
                name: campaignName,
                totalSent: totalEmails,
                delivered: delivered,
                opened: opened,
                hardBounces: hardBounces,
                softBounces: softBounces,
                executedAt: new Date()
            };
            
            updateAnalytics();
            alert(`Campaign "${campaignName}" executed successfully! Check the Analytics tab for results.`);
        }

        function scheduleCampaignExecution(date, time) {
            const campaignName = document.getElementById('campaignName').value;
            alert(`Campaign "${campaignName}" scheduled for ${date} at ${time}. It will be executed automatically at the scheduled time.`);
        }

        // Analytics and reporting
        function updateAnalytics() {
            if (!campaignData.totalSent) return;
            
            const deliveryRate = ((campaignData.delivered / campaignData.totalSent) * 100).toFixed(1);
            const openRate = ((campaignData.opened / campaignData.delivered) * 100).toFixed(1);
            const bounceRate = (((campaignData.hardBounces + campaignData.softBounces) / campaignData.totalSent) * 100).toFixed(1);
            
            document.getElementById('totalSent').textContent = campaignData.totalSent.toLocaleString();
            document.getElementById('deliveryRate').textContent = deliveryRate + '%';
            document.getElementById('openRate').textContent = openRate + '%';
            document.getElementById('bounceRate').textContent = bounceRate + '%';
            
            // Update bounce lists
            updateBounceList('hardBounceList', campaignData.hardBounces);
            updateBounceList('softBounceList', campaignData.softBounces);
            
            // Update charts
            updateCharts();
        }

        function updateBounceList(elementId, count) {
            const listElement = document.getElementById(elementId);
            listElement.innerHTML = '';
            
            for (let i = 0; i < Math.min(count, 10); i++) {
                const div = document.createElement('div');
                div.textContent = `user${i + 1}@example${Math.floor(Math.random() * 100)}.com`;
                listElement.appendChild(div);
            }
            
            if (count > 10) {
                const div = document.createElement('div');
                div.textContent = `... and ${count - 10} more`;
                div.className = 'font-semibold';
                listElement.appendChild(div);
            }
        }

        // Charts initialization
        let deliveryChart, openRateChart;

        function initializeCharts() {
            // Delivery Chart
            const deliveryCtx = document.getElementById('deliveryChart').getContext('2d');
            deliveryChart = new Chart(deliveryCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Delivered', 'Hard Bounce', 'Soft Bounce'],
                    datasets: [{
                        data: [85, 8, 7],
                        backgroundColor: ['#10B981', '#EF4444', '#F59E0B'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Open Rate Chart
            const openRateCtx = document.getElementById('openRateChart').getContext('2d');
            openRateChart = new Chart(openRateCtx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'Open Rate %',
                        data: [18, 22, 25, 28],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 40
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function updateCharts() {
            if (!campaignData.totalSent) return;
            
            const delivered = campaignData.delivered;
            const hardBounces = campaignData.hardBounces;
            const softBounces = campaignData.softBounces;
            
            deliveryChart.data.datasets[0].data = [delivered, hardBounces, softBounces];
            deliveryChart.update();
            
            // Update open rate chart with new data
            const openRate = (campaignData.opened / delivered * 100).toFixed(1);
            openRateChart.data.datasets[0].data.push(parseFloat(openRate));
            openRateChart.data.labels.push('Latest');
            openRateChart.update();
        }

        // Download reports
        document.getElementById('downloadReports').addEventListener('click', function() {
            if (!campaignData.totalSent) {
                alert('No campaign data available to download.');
                return;
            }
            
            const reportData = {
                campaignName: campaignData.name,
                executedAt: campaignData.executedAt,
                totalSent: campaignData.totalSent,
                delivered: campaignData.delivered,
                opened: campaignData.opened,
                hardBounces: campaignData.hardBounces,
                softBounces: campaignData.softBounces,
                deliveryRate: (campaignData.delivered / campaignData.totalSent * 100).toFixed(2) + '%',
                openRate: (campaignData.opened / campaignData.delivered * 100).toFixed(2) + '%',
                bounceRate: ((campaignData.hardBounces + campaignData.softBounces) / campaignData.totalSent * 100).toFixed(2) + '%'
            };
            
            const csvContent = Object.entries(reportData).map(([key, value]) => `${key},${value}`).join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `campaign_report_${campaignData.name}_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'978c75c1c77a7e8a',t:'MTc1NjgxMDM2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
